# Cascade Filter

Towards a Distributed Filtering Service

--

## Serialising and Deserialising

```python
class Block:
  def constructor(is_occupied, is_continuation, is_shifted, remainder):
    this.flags = is_occupied << 2 + is_continuation << 1 + is_shifted
    this.remainder = remainder

  def serialize():
    return this.flags << sizeof(this.remainder) + this.remainder

  @static
  def deserialize(bits)
    block = new Block()
    block.flags = first(bits, 3)
    block.remainder = flip(block.flags) << (sizeof(bits) - 3) & bits
```

--

## Serialising and Deserializing (continued)

```python

class QuotientFilter:
  # other code

  def get_blocks_from_remainders(blocks, quotient, remainders):
    if remainder is empty and len(blocks) <= quotient:
      return [new Block(
        is_occupied: False,
        is_continuation: False,
        is_shifted: False
      )]

    first_block = new Block()
    for remainder in remainders:
      block = Block(is_occupied: True,
                    is_continuation: False,
                    is_shifted: len(blocks) == quotient)

  def get_blocks():
    blocks = []
    for quotient, remainders in this.rep:

    return blocks
```
